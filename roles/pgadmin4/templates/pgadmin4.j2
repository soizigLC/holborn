#!/bin/sh

DAEMON="{{ pgadmin4_python_dist_dir }}/pgadmin4/pgAdmin4.py"
DAEMON_NAME="pgAdmin4.py"

test -x $DAEMON || exit 0
 
. /lib/lsb/init-functions
 
d_start () {
    log_daemon_msg "Starting system $DAEMON_NAME daemon"
    start-stop-daemon --background --name $DAEMON_NAME --start --quiet --exec $DAEMON
    log_end_msg $?
}
 
d_stop () {
    log_daemon_msg "Stopping system $DAEMON_NAME daemon"
    start-stop-daemon --name $DAEMON_NAME --stop --retry 5 --quiet --name $dDAEMON_NAME
    log_end_msg $?
}
 
case "$1" in
 
        start|stop)
                d_${1}
                ;;
 
        restart|reload|force-reload)
                d_stop
                d_start
                ;;
 
        force-stop)
               d_stop
                killall -q $DAEMON_NAME || true
                sleep 2
                killall -q -9 $DAEMON_NAME || true
                ;;
 
        status)
                status_of_proc "$DAEMON_NAME" "$DAEMON" "system-wide $DAEMON_NAME" && exit 0 || exit $?
                ;;

        *)
                echo "Usage: /etc/init.d/pgadmin4 {start|stop|force-stop|restart|reload|force-reload|status}"
                exit 1
                ;;
esac

exit 0